<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Crypto Clicker</title>
  <style>
    body {
      background: #0f0f0f;
      color: #fff;
      font-family: 'Segoe UI', sans-serif;
      text-align: center;
      padding: 20px;
    }
    input, button {
      padding: 10px;
      font-size: 16px;
      margin: 5px;
      border-radius: 8px;
      border: none;
    }
    .click-button {
      background: linear-gradient(135deg, #00ffa6, #00c3ff);
      color: white;
      padding: 15px 30px;
      font-size: 18px;
      border-radius: 12px;
      cursor: pointer;
      margin: 10px;
    }
    #profilePanel {
      position: absolute;
      top: 20px;
      left: 20px;
      background-color: #1a1a1a;
      padding: 15px;
      border-radius: 12px;
      box-shadow: 0 0 10px #00c3ff;
      width: 200px;
      text-align: left;
    }
    #message {
      margin-top: 10px;
      color: #ff5555;
    }
  </style>
</head>
<body>

<div id="profilePanel">
  <div><strong>Player:</strong> <span id="profileName">Anonymous</span></div>
  <div><strong>Click Power:</strong> <span id="profileClickPower">1</span></div>
  <div><strong>Autoclicker:</strong> <span id="profileAutoclick">Inactive</span></div>
  <div><strong>Tokens:</strong> <span id="profileTokens">0</span></div>
  <div><button class="click-button" onclick="signOut()">Sign Out</button></div>
</div>

<h1>Crypto Clicker</h1>

<div id="authSection">
  <button class="click-button" onclick="signInWithGoogle()">Sign in with Google</button>
</div>

<div id="gameSection" style="display:none;">
  <div id="counter">Tokens: 0</div>
  <div id="message"></div>
  <button class="click-button" onclick="clickToken()">Collect Token</button>
  <button class="click-button" onclick="buyAutoclicker()">Buy Autoclicker (200)</button>
</div>

<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyBGK_Tuwke5TfltTt9Dtkeh9aWuZkSNFt4",
    authDomain: "cryptoclicker-e6a69.firebaseapp.com",
    databaseURL: "https://cryptoclicker-e6a69-default-rtdb.firebaseio.com",
    projectId: "cryptoclicker-e6a69",
    storageBucket: "cryptoclicker-e6a69.appspot.com",
    messagingSenderId: "290231276060",
    appId: "1:290231276060:web:406a5f2ce9c3a0a354c5d9"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();
  const auth = firebase.auth();

  let user = null;
  let score = 0;
  let clickPower = 1;
  let autoclickInterval = null;

  function updateUI() {
    document.getElementById("profileName").innerText = user?.displayName || "Anonymous";
    document.getElementById("profileClickPower").innerText = clickPower;
    document.getElementById("profileTokens").innerText = score;
    document.getElementById("counter").innerText = "Tokens: " + score;
  }

  function updateAutoclickStatus(active) {
    document.getElementById("profileAutoclick").innerText = active ? "Active" : "Inactive";
  }

  function clickToken() {
    score += clickPower;
    updateUI();
  }

  function showMessage(msg) {
    const el = document.getElementById("message");
    el.innerText = msg;
    setTimeout(() => el.innerText = "", 3000);
  }

  function startAutoclicker(endTime) {
    if (autoclickInterval) clearInterval(autoclickInterval);

    updateAutoclickStatus(true);
    autoclickInterval = setInterval(() => {
      if (Date.now() >= endTime) {
        clearInterval(autoclickInterval);
        updateAutoclickStatus(false);
        db.ref("leaderboard/" + user.uid).update({
          autoclickActive: false,
          autoclickEndTime: 0
        });
        return;
      }
      clickToken();
    }, 1000);
  }

  function buyAutoclicker() {
    if (score < 200) {
      showMessage("Not enough tokens!");
      return;
    }

    const endTime = Date.now() + 60000;
    score -= 200;
    updateUI();
    updateAutoclickStatus(true);
    showMessage("Autoclicker activated for 1 minute!");

    db.ref("leaderboard/" + user.uid).update({
      score,
      autoclickActive: true,
      autoclickEndTime: endTime
    });

    startAutoclicker(endTime);
  }

  function loadPlayerData(uid) {
    db.ref("leaderboard/" + uid).once("value").then(snapshot => {
      const data = snapshot.val();
      if (data) {
        score = data.score || 0;
        clickPower = data.clickPower || 1;
        updateUI();

        if (data.autoclickActive && Date.now() < data.autoclickEndTime) {
          startAutoclicker(data.autoclickEndTime);
        } else {
          updateAutoclickStatus(false);
        }
      }
    });
  }

  function signInWithGoogle() {
    const provider = new firebase.auth.GoogleAuthProvider();
    auth.signInWithPopup(provider).then(result => {
      user = result.user;
      document.getElementById("authSection").style.display = "none";
      document.getElementById("gameSection").style.display = "block";
      loadPlayerData(user.uid);
    });
  }

  function signOut() {
    auth.signOut().then(() => {
      user = null;
      score = 0;
      clickPower = 1;
      clearInterval(autoclickInterval);
      document.getElementById("authSection").style.display = "block";
      document.getElementById("gameSection").style.display = "none";
      updateUI();
    });
  }

  auth.onAuthStateChanged(currentUser => {
    if (currentUser) {
      user = currentUser;
      document.getElementById("authSection").style.display = "none";
      document.getElementById("gameSection").style.display = "block";
      loadPlayerData(user.uid);
    }
  });
</script>
</body>
</html>
